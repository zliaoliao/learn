å‰ç«¯æ‰“åŒ…å·¥å…·åœ¨é«˜çº§å‰ç«¯é¢è¯•ä¸­éå¸¸é‡è¦ï¼Œç‰¹åˆ«æ˜¯ **Webpack** å’Œ **Vite**ï¼Œä¸ä»…è€ƒå¯ŸåŸç†ï¼Œè¿˜è€ƒå¯Ÿä½ èƒ½å¦çµæ´»é…ç½®ã€ä¼˜åŒ–æ€§èƒ½ã€è§£å†³å®é™…é—®é¢˜ã€‚ä»¥ä¸‹æ˜¯åº”å¯¹**é¢è¯•**å’Œ**åŠ æ·±ç†è§£**æ—¶ï¼Œå»ºè®®é‡ç‚¹å¤ä¹ çš„å†…å®¹ï¼ŒæŒ‰é‡è¦ç¨‹åº¦æ’åºã€å¹¶é™„å¸¦æ¨èç†è§£è§’åº¦ï¼š

---

### âœ… ç»Ÿä¸€é‡ç‚¹ï¼šWebpack vs Vite çš„æ ¸å¿ƒåŒºåˆ«ï¼ˆå»ºè®®æ”¾å¼€å¤´ä½œä¸ºå¯¹æ¯”æ€»è§ˆï¼‰

| å¯¹æ¯”é¡¹      | Webpack        | Vite                   |
| -------- | -------------- | ---------------------- |
| å¯åŠ¨é€Ÿåº¦     | æ…¢ï¼ˆéœ€è¦æ‰“åŒ…ï¼‰        | å¿«ï¼ˆåŸºäºåŸç”Ÿ ESMï¼Œæ— éœ€æ‰“åŒ…ï¼‰       |
| æ„å»ºæ–¹å¼     | ä¾èµ– Bundle      | å¼€å‘é˜¶æ®µåŸç”Ÿæ¨¡å— + ç”Ÿäº§ç”¨ Rollup  |
| çƒ­æ›´æ–°ï¼ˆHMRï¼‰ | æ¨¡å—çº§æ›¿æ¢          | å±€éƒ¨æ›´æ–° + æ›´å¿«çš„æ¨¡å—çƒ­æ›¿æ¢        |
| é…ç½®éš¾åº¦     | é«˜ï¼Œå¤æ‚æ’ä»¶ç”Ÿæ€       | å¼€ç®±å³ç”¨ï¼Œé…ç½®æ›´ç®€æ´             |
| æ’ä»¶ç³»ç»Ÿ     | Tapable æ„å»ºç”Ÿå‘½å‘¨æœŸ | æ’ä»¶åŸºäº Rollup æ’ä»¶ä½“ç³»ï¼Œæ”¯æŒä¸­é—´ä»¶ |
| å¼€å‘ä½“éªŒ     | æ›´ä¼ ç»Ÿ            | æ›´ç°ä»£ï¼Œé€‚åˆ Vue3ã€React é¡¹ç›®   |

---

### ğŸ” Webpack é‡ç‚¹å¤ä¹ æ¨¡å—ï¼ˆå¸¦é¢è¯•å…³é”®è¯ï¼‰ï¼š

#### 1. **æ ¸å¿ƒæ¦‚å¿µä¸æ‰“åŒ…æµç¨‹ï¼ˆé¢è¯•é«˜é¢‘ï¼‰**

* Entry / Output / Loader / Plugin
* æ‰“åŒ…è¿‡ç¨‹ï¼šæ¨¡å—ä¾èµ–æ”¶é›† â†’ loader è½¬æ¢ â†’ plugin æ’å…¥ â†’ output è¾“å‡º
* æ¨¡å—è§£ææœºåˆ¶ï¼ˆ`resolve` è§£æåˆ«åã€åç¼€ã€æ¨¡å—è·¯å¾„ï¼‰
* æ‡’åŠ è½½ï¼š`import()` + code splittingï¼ˆ`SplitChunksPlugin`ï¼‰
* Tree-shaking æ¡ä»¶ï¼šESM + æ— å‰¯ä½œç”¨ + production æ¨¡å¼

#### 2. **å¸¸ç”¨ Loader/Pluginï¼ˆæŒæ¡ç”¨é€” + é…ç½®ï¼‰**

* `babel-loader`, `css-loader`, `style-loader`, `file-loader`, `url-loader`
* `HtmlWebpackPlugin`, `DefinePlugin`, `MiniCssExtractPlugin`, `CleanWebpackPlugin`

#### 3. **æ€§èƒ½ä¼˜åŒ–**

* æ„å»ºæ€§èƒ½ï¼š`cache-loader`ã€`thread-loader`ã€`exclude/include` ä¼˜åŒ–
* æ‰“åŒ…æ€§èƒ½ï¼š`SplitChunks`, `TerserPlugin`, `bundle analyzer`
* èµ„æºä¼˜åŒ–ï¼š`image-webpack-loader`ã€æ‡’åŠ è½½ï¼ˆ`import()`ï¼‰ã€æŒ‰éœ€åŠ è½½

#### 4. **HMR çƒ­æ›´æ–°**

* `webpack-dev-server` åŸç†ï¼Œæ¨¡å—çƒ­æ›¿æ¢é€»è¾‘ï¼Œæ›´æ–°å±€éƒ¨ç»„ä»¶çŠ¶æ€

#### 5. **ç”Ÿäº§æ„å»º**

* `mode: production` + `optimization` é…ç½®é¡¹ï¼ˆå‹ç¼©ã€ä»£ç åˆ†å‰²ç­‰ï¼‰
* SourceMap çš„ç±»å‹ä¸ç”Ÿäº§ç¯å¢ƒå»ºè®®é…ç½®ï¼ˆå¦‚ï¼š`cheap-module-source-map`ï¼‰

---

### âš¡ Vite é‡ç‚¹å¤ä¹ æ¨¡å—ï¼ˆé¢è¯•è¶Šæ¥è¶Šå¸¸è§ï¼‰ï¼š

#### 1. **å¼€å‘æ„å»ºæœºåˆ¶**

* å¼€å‘é˜¶æ®µï¼šåŸç”Ÿ ESMï¼Œä½¿ç”¨æµè§ˆå™¨åŠ¨æ€åŠ è½½æ¨¡å—ï¼Œæ— éœ€æ‰“åŒ…
* ç”Ÿäº§é˜¶æ®µï¼šä½¿ç”¨ Rollup æ‰“åŒ…ä¼˜åŒ–ï¼Œé…ç½®é¡¹å…¼å®¹ Rollup æ’ä»¶
* æ”¯æŒ TypeScriptã€Vueã€Reactã€SASS ç­‰è‡ªåŠ¨å¤„ç†

#### 2. **æ ¸å¿ƒåŠŸèƒ½**

* å¿«é€Ÿå¯åŠ¨ï¼ˆä¾èµ–é¢„æ„å»º + åŸç”Ÿæ¨¡å—ï¼‰
* æ’ä»¶ç³»ç»Ÿï¼ˆåŸºäº Rollup + `configureServer` ä¸­é—´ä»¶æœºåˆ¶ï¼‰
* é…ç½®æ–‡ä»¶ vite.config.tsï¼š

  * `plugins` æ’ä»¶æ³¨å†Œ
  * `resolve.alias` é…ç½®
  * `define` å…¨å±€å˜é‡æ³¨å…¥
  * `build.rollupOptions` äº§ç‰©æ§åˆ¶
  * `server.proxy` è·¨åŸŸä»£ç†è®¾ç½®

#### 3. **ä¼˜åŒ–ç›¸å…³**

* `optimizeDeps`ï¼šä¼˜åŒ–ä¾èµ–é¢„æ„å»º
* SSR æ”¯æŒ / PWA æ’ä»¶
* é™æ€èµ„æºå¤„ç†ï¼ˆpublic ç›®å½• vs ç›´æ¥å¯¼å…¥ï¼‰

#### 4. **ä¸ Webpack çš„å¼‚åŒç‚¹ï¼ˆç»“åˆé¡¹ç›®ç»éªŒè¯´æ˜ï¼‰**

* Vite ä¸æ‰“åŒ…ä¾èµ–ï¼Œæ¨¡å—æ˜¯æŒ‰éœ€æ‹‰å–ï¼ˆåªå¤„ç†ä¿®æ”¹æ¨¡å—ï¼‰
* Webpack åœ¨å¼€å‘ç¯å¢ƒæ‰“åŒ…æ…¢ï¼Œä½†ç”Ÿæ€æˆç†Ÿï¼Œå¯æ§æ€§å¼º

---

### ğŸ¯ é¢è¯•å»ºè®®å®æˆ˜é¢˜

å¯ä»¥å‡†å¤‡ä»¥ä¸‹é¢è¯•å›ç­”æˆ–ç¬”è¯•ï¼š

* æ‰‹å†™ç®€æ˜“ç‰ˆ Webpack æ‰“åŒ…æµç¨‹ï¼ˆæˆ– explain æºç æ„å»ºæµç¨‹ï¼‰
* é¡¹ç›®ä¸­ä¼˜åŒ– Webpack æ„å»ºé€Ÿåº¦çš„å®æˆ˜æŠ€å·§
* ç”¨ Vite æ­å»º React/Vue é¡¹ç›®ä¸­å¦‚ä½•å¤„ç†å¤§å‹ç¬¬ä¸‰æ–¹åº“ä¼˜åŒ–
* Webpack å¦‚ä½•å®ç° Tree-shaking å’Œæ‡’åŠ è½½
* Vite æ˜¯å¦‚ä½•åšåˆ°å†·å¯åŠ¨å¿«çš„ï¼Ÿæ˜¯å¦é€‚åˆ SSRï¼Ÿ

---

### ğŸ“˜ æ¨èé¢å¤–ç†è§£ï¼š

* Webpack æ’ä»¶æœºåˆ¶ç”¨çš„æ˜¯ **Tapable**ï¼ˆå‘å¸ƒè®¢é˜…æ¨¡å‹ï¼‰ => å¯ç±»æ¯” Vue ç”Ÿå‘½å‘¨æœŸé’©å­
* Vite å†…éƒ¨ä½¿ç”¨ **esbuild** åšä¾èµ–é¢„æ„å»ºï¼Œè¿œæ¯” Babel å¿«
* äºŒè€…éƒ½å¯ä»¥é€šè¿‡æ’ä»¶è‡ªå®šä¹‰æ„å»ºè¡Œä¸ºï¼ˆä½† Vite æ›´ç°ä»£ï¼‰

---

éœ€è¦æˆ‘æŠŠè¿™ä»½å†…å®¹æ•´ç†æˆ Markdown æ–‡ä»¶æˆ–å¤ä¹ æçº²æ ¼å¼å—ï¼Ÿ



ä»¥ä¸‹æ˜¯é’ˆå¯¹é«˜çº§å‰ç«¯é¢è¯•ä¸­**Webpack / Vite å®æˆ˜é¢˜**æœ€å¸¸è€ƒçš„äº”ä¸ªé—®é¢˜åŠ**æ ‡å‡†ç­”é¢˜å‚è€ƒç­”æ¡ˆ**ï¼Œæ¯é¢˜é™„åŠ ç®€è¦è¯´æ˜ä¸å»¶ä¼¸å»ºè®®ï¼Œæ–¹ä¾¿ä½ é¢è¯•æ—¶çµæ´»å±•å¼€ã€‚

---

## âœ… é¢˜ç›®ä¸€ï¼šè¯·ç®€è¿° Webpack çš„æ„å»ºæµç¨‹ï¼Œå¹¶è¯´æ˜ Loader ä¸ Plugin çš„ä½œç”¨åŒºåˆ«

### ğŸ¯ ç­”é¢˜å‚è€ƒï¼š

Webpack æ„å»ºæµç¨‹ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹ 5 ä¸ªé˜¶æ®µï¼š

1. **åˆå§‹åŒ–**ï¼šè¯»å–é…ç½®ï¼Œæ³¨å†Œæ’ä»¶ï¼ˆé€šè¿‡ Tapableï¼‰ã€‚
2. **æ„å»ºæ¨¡å—ä¾èµ–å›¾**ï¼šä»å…¥å£æ–‡ä»¶é€’å½’è§£æä¾èµ–ï¼Œè°ƒç”¨å¯¹åº” Loader å¤„ç†èµ„æºã€‚
3. **æ¨¡å—è½¬æ¢**ï¼šä½¿ç”¨ Loader å¯¹é JS æ¨¡å—ï¼ˆå¦‚ `.vue`ã€`.scss`ï¼‰è¿›è¡Œè½¬æ¢ä¸º JS æ¨¡å—ã€‚
4. **ç¼–è¯‘ Chunk**ï¼šæŒ‰éœ€åˆå¹¶æ¨¡å—ä¸º Chunkã€‚
5. **è¾“å‡ºèµ„æº**ï¼šè°ƒç”¨ Plugin å¤„ç†èµ„æºï¼ˆå‹ç¼©ã€æ³¨å…¥ HTMLï¼‰ï¼Œæœ€ç»ˆè¾“å‡ºåˆ°æŒ‡å®šè·¯å¾„ã€‚

> **Loader æ˜¯æ¨¡å—è½¬æ¢å™¨**ï¼Œåœ¨æ¨¡å—åŠ è½½æ—¶æŒ‰é¡ºåºå¤„ç†æºæ–‡ä»¶ï¼Œå¦‚ `babel-loader`ã€‚
>
> **Plugin æ˜¯æ‰©å±•å™¨**ï¼Œåœ¨æ„å»ºæµç¨‹çš„å„ä¸ªé˜¶æ®µæ‰§è¡Œé’©å­å‡½æ•°ï¼Œå¦‚ `HtmlWebpackPlugin`ã€`DefinePlugin`ã€‚

### ğŸ’¡ å»¶ä¼¸ï¼š

* Loader æ˜¯å‡½æ•°ï¼Œæœ¬è´¨æ˜¯å¯¹æ¨¡å—æ–‡ä»¶å†…å®¹çš„è½¬æ¢ã€‚
* Plugin æ˜¯ç±»ï¼Œä½¿ç”¨ `apply(compiler)` æ³¨å†Œåˆ° Webpack ç”Ÿå‘½å‘¨æœŸä¸­ã€‚

---

## âœ… é¢˜ç›®äºŒï¼šå¦‚ä½•ç”¨ Webpack å®ç°ä»£ç åˆ†å‰²ï¼ˆCode Splittingï¼‰ï¼Ÿè¯·è¯´æ˜åŸç†ä¸é…ç½®æ–¹å¼

### ğŸ¯ ç­”é¢˜å‚è€ƒï¼š

Webpack æ”¯æŒä¸‰ç§æ–¹å¼å®ç°ä»£ç åˆ†å‰²ï¼š

1. **å…¥å£åˆ†å‰²**ï¼ˆå¤šå…¥å£ï¼‰ï¼š

   ```js
   entry: {
     main: './src/index.js',
     vendor: './src/vendor.js'
   }
   ```

2. **æ‰‹åŠ¨å¼‚æ­¥å¯¼å…¥**ï¼ˆæ¨èï¼‰ï¼š

   ```js
   import('./moduleA').then(...)
   ```

3. **SplitChunksPlugin è‡ªåŠ¨æ‹†åˆ†å…¬å…±æ¨¡å—**ï¼š

   ```js
   optimization: {
     splitChunks: {
       chunks: 'all',
       cacheGroups: {
         vendors: {
           test: /[\\/]node_modules[\\/]/,
           name: 'vendors',
           chunks: 'all',
         }
       }
     }
   }
   ```

> **åŸç†**ï¼šWebpack ä¼šè¯†åˆ«å¼‚æ­¥ä¾èµ–ï¼Œå°†å…¶æ‰“åŒ…æˆç‹¬ç«‹çš„ Chunkï¼ŒæŒ‰éœ€åŠ è½½ï¼Œå‡å°‘é¦–å± JS ä½“ç§¯ã€‚

---

## âœ… é¢˜ç›®ä¸‰ï¼šVite ä¸ºä½•å¯åŠ¨é€Ÿåº¦æ¯” Webpack å¿«ï¼Ÿè¯·è§£é‡Šå…¶åŸç†

### ğŸ¯ ç­”é¢˜å‚è€ƒï¼š

Vite å¯åŠ¨å¿«çš„åŸå› ä¸»è¦æœ‰ä¸¤ç‚¹ï¼š

1. **åŸºäºåŸç”Ÿ ES Module å¼€å‘**ï¼šVite åˆ©ç”¨æµè§ˆå™¨åŸç”Ÿæ”¯æŒçš„ ESMï¼Œåªåœ¨é¦–æ¬¡è¯·æ±‚æ—¶æŒ‰éœ€åŠ è½½æ¨¡å—ï¼Œæ— éœ€æ‰“åŒ…ã€‚
2. **ä¾èµ–é¢„æ„å»º**ï¼šä½¿ç”¨ `esbuild` å¯¹ä¾èµ–è¿›è¡Œä¸€æ¬¡æ€§é¢„æ„å»ºï¼Œé€Ÿåº¦æ¯” Babel å¿« 10-100 å€ã€‚

```js
optimizeDeps: {
  include: ['lodash']
}
```

> Webpack åœ¨å¼€å‘é˜¶æ®µæ‰“åŒ…æ•´ä¸ªä¾èµ–å›¾ï¼Œå¯åŠ¨ç¼“æ…¢ï¼›Vite åˆ©ç”¨åŸç”Ÿæ¨¡å— + esbuildï¼Œä»…é¢„æ„å»ºç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œæå¤§æå‡äº†å¼€å‘ä½“éªŒã€‚

---

## âœ… é¢˜ç›®å››ï¼šè¯·è¯´è¯´ä½ é¡¹ç›®ä¸­ Webpack æ€§èƒ½ä¼˜åŒ–çš„å®æˆ˜ç»éªŒ

### ğŸ¯ ç­”é¢˜å‚è€ƒï¼š

ä»¥ä¸‹æ˜¯æˆ‘å®é™…ä¼˜åŒ–ç»éªŒä¸­å¸¸ç”¨çš„ç­–ç•¥ï¼š

#### æ„å»ºé€Ÿåº¦ä¼˜åŒ–ï¼š

* ä½¿ç”¨ `thread-loader` + `cache-loader` æå‡ Loader æ‰§è¡Œæ•ˆç‡ã€‚
* ç²¾å‡†ä½¿ç”¨ `include` / `exclude` é™åˆ¶ Babel ç¼–è¯‘èŒƒå›´ã€‚
* ä½¿ç”¨ `resolve.alias` åŠ å¿«è·¯å¾„è§£æã€‚

#### æ„å»ºä½“ç§¯ä¼˜åŒ–ï¼š

* å¼€å¯ Tree-shakingï¼ˆä½¿ç”¨ ES Module + `"sideEffects": false`ï¼‰
* ä½¿ç”¨ `MiniCssExtractPlugin` æŠ½ç¦» CSS
* ä½¿ç”¨ `TerserPlugin` å‹ç¼© JS
* æŒ‰éœ€åŠ è½½ï¼ˆä½¿ç”¨ `import()` å¼‚æ­¥åŠ è½½å¤§æ¨¡å—ï¼‰
* ä½¿ç”¨ `webpack-bundle-analyzer` åˆ†æåŒ…ä½“ç§¯

#### ç¤ºä¾‹é…ç½®ï¼š

```js
optimization: {
  minimize: true,
  splitChunks: {
    chunks: 'all',
  },
  runtimeChunk: 'single'
}
```

---

## âœ… é¢˜ç›®äº”ï¼šVite é¡¹ç›®ä¸­å¦‚æœå¼•å…¥å¤§å‹ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ lodashï¼‰ï¼Œå¦‚ä½•è¿›è¡Œä¼˜åŒ–ï¼Ÿ

### ğŸ¯ ç­”é¢˜å‚è€ƒï¼š

Vite ä¸­ä¼˜åŒ–å¤§å‹ä¾èµ–åº“çš„æ–¹æ³•ï¼š

1. **ä¾èµ–é¢„æ„å»ºç¼“å­˜**ï¼š

   ```ts
   optimizeDeps: {
     include: ['lodash']
   }
   ```

   é¿å…å¼€å‘ç¯å¢ƒæ¯æ¬¡éƒ½é‡æ–°è§£æã€‚

2. **æŒ‰éœ€å¼•å…¥**ï¼š
   åˆ©ç”¨ `lodash-es` + Tree-shaking

   ```js
   import debounce from 'lodash-es/debounce'
   ```

3. **ç”Ÿäº§æ‰“åŒ…ä¼˜åŒ–**ï¼ˆRollup é…ç½®ï¼‰ï¼š

   ```ts
   build: {
     rollupOptions: {
       output: {
         manualChunks: {
           lodash: ['lodash-es']
         }
       }
     }
   }
   ```

4. **CDN å¤–é“¾ï¼ˆå¯é€‰ï¼‰**ï¼š
   é…åˆ `vite-plugin-html` ä½¿ç”¨ CDN åŠ é€ŸåŠ è½½ï¼š

   ```js
   define: {
     lodash: 'window._'
   }
   ```

---

### âœ… æ€»ç»“

| è€ƒé¢˜             | æ¶‰åŠæŠ€èƒ½                       | æ¨èæ‹“å±•                           |
| -------------- | -------------------------- | ------------------------------ |
| Webpack æ„å»ºæµç¨‹   | Tapableã€æ¨¡å—ç³»ç»Ÿ               | æ‰‹å†™æ’ä»¶ç»ƒä¹                          |
| Code Splitting | import()ã€SplitChunksPlugin | åŠ¨æ€è·¯ç”±æ‡’åŠ è½½å®è·µ                      |
| Vite å¯åŠ¨åŸç†      | ESM + esbuild              | æ¯”è¾ƒ vite ä¸ Webpack çš„ dev-server |
| æ€§èƒ½ä¼˜åŒ–å®æˆ˜         | Loader ä¼˜åŒ–ã€Plugin è°ƒæ•´        | ä½¿ç”¨ webpack-analyzer            |
| Vite å¤§åŒ…ä¼˜åŒ–      | optimizeDepsã€rollupOptions | åŠ¨æ€å¯¼å…¥ä¸ bundle size å¯¹æ¯”           |

---

éœ€è¦æˆ‘æŠŠè¿™äº›é¢˜ç›® + ç­”æ¡ˆæ•´ç†æˆä¸€ä»½ markdown é¢è¯•æ‰‹å†Œå—ï¼Ÿæˆ–è€…ä½ å¸Œæœ›åŠ ä¸ŠæŸä¸€å—æ‰©å±•é¢˜å‹ï¼Ÿ

