å‰ç«¯æ‰“åŒ…å·¥å…·åœ¨é«˜çº§å‰ç«¯é¢è¯•ä¸­éå¸¸é‡è¦ï¼Œç‰¹åˆ«æ˜¯ **Webpack** å’Œ **Vite**ï¼Œä¸ä»…è€ƒå¯ŸåŸç†ï¼Œè¿˜è€ƒå¯Ÿä½ èƒ½å¦çµæ´»é…ç½®ã€ä¼˜åŒ–æ€§èƒ½ã€è§£å†³å®é™…é—®é¢˜ã€‚ä»¥ä¸‹æ˜¯åº”å¯¹**é¢è¯•**å’Œ**åŠ æ·±ç†è§£**æ—¶ï¼Œå»ºè®®é‡ç‚¹å¤ä¹ çš„å†…å®¹ï¼ŒæŒ‰é‡è¦ç¨‹åº¦æ’åºã€å¹¶é™„å¸¦æ¨èç†è§£è§’åº¦ï¼š

---

### âœ… ç»Ÿä¸€é‡ç‚¹ï¼šWebpack vs Vite çš„æ ¸å¿ƒåŒºåˆ«ï¼ˆå»ºè®®æ”¾å¼€å¤´ä½œä¸ºå¯¹æ¯”æ€»è§ˆï¼‰

| å¯¹æ¯”é¡¹      | Webpack        | Vite                   |
| -------- | -------------- | ---------------------- |
| å¯åŠ¨é€Ÿåº¦     | æ…¢ï¼ˆéœ€è¦æ‰“åŒ…ï¼‰        | å¿«ï¼ˆåŸºäºåŸç”Ÿ ESMï¼Œæ— éœ€æ‰“åŒ…ï¼‰       |
| æ„å»ºæ–¹å¼     | ä¾èµ– Bundle      | å¼€å‘é˜¶æ®µåŸç”Ÿæ¨¡å— + ç”Ÿäº§ç”¨ Rollup  |
| çƒ­æ›´æ–°ï¼ˆHMRï¼‰ | æ¨¡å—çº§æ›¿æ¢          | å±€éƒ¨æ›´æ–° + æ›´å¿«çš„æ¨¡å—çƒ­æ›¿æ¢        |
| é…ç½®éš¾åº¦     | é«˜ï¼Œå¤æ‚æ’ä»¶ç”Ÿæ€       | å¼€ç®±å³ç”¨ï¼Œé…ç½®æ›´ç®€æ´             |
| æ’ä»¶ç³»ç»Ÿ     | Tapable æ„å»ºç”Ÿå‘½å‘¨æœŸ | æ’ä»¶åŸºäº Rollup æ’ä»¶ä½“ç³»ï¼Œæ”¯æŒä¸­é—´ä»¶ |
| å¼€å‘ä½“éªŒ     | æ›´ä¼ ç»Ÿ            | æ›´ç°ä»£ï¼Œé€‚åˆ Vue3ã€React é¡¹ç›®   |

---

### ğŸ” Webpack é‡ç‚¹å¤ä¹ æ¨¡å—ï¼ˆå¸¦é¢è¯•å…³é”®è¯ï¼‰ï¼š

#### 1. **æ ¸å¿ƒæ¦‚å¿µä¸æ‰“åŒ…æµç¨‹ï¼ˆé¢è¯•é«˜é¢‘ï¼‰**

* Entry / Output / Loader / Plugin
* æ‰“åŒ…è¿‡ç¨‹ï¼šæ¨¡å—ä¾èµ–æ”¶é›† â†’ loader è½¬æ¢ â†’ plugin æ’å…¥ â†’ output è¾“å‡º
* æ¨¡å—è§£ææœºåˆ¶ï¼ˆ`resolve` è§£æåˆ«åã€åç¼€ã€æ¨¡å—è·¯å¾„ï¼‰
* æ‡’åŠ è½½ï¼š`import()` + code splittingï¼ˆ`SplitChunksPlugin`ï¼‰
* Tree-shaking æ¡ä»¶ï¼šESM + æ— å‰¯ä½œç”¨ + production æ¨¡å¼

#### 2. **å¸¸ç”¨ Loader/Pluginï¼ˆæŒæ¡ç”¨é€” + é…ç½®ï¼‰**

* `babel-loader`, `css-loader`, `style-loader`, `file-loader`, `url-loader`
* `HtmlWebpackPlugin`, `DefinePlugin`, `MiniCssExtractPlugin`, `CleanWebpackPlugin`

#### 3. **æ€§èƒ½ä¼˜åŒ–**

* æ„å»ºæ€§èƒ½ï¼š`cache-loader`ã€`thread-loader`ã€`exclude/include` ä¼˜åŒ–
* æ‰“åŒ…æ€§èƒ½ï¼š`SplitChunks`, `TerserPlugin`, `bundle analyzer`
* èµ„æºä¼˜åŒ–ï¼š`image-webpack-loader`ã€æ‡’åŠ è½½ï¼ˆ`import()`ï¼‰ã€æŒ‰éœ€åŠ è½½

#### 4. **HMR çƒ­æ›´æ–°**

* `webpack-dev-server` åŸç†ï¼Œæ¨¡å—çƒ­æ›¿æ¢é€»è¾‘ï¼Œæ›´æ–°å±€éƒ¨ç»„ä»¶çŠ¶æ€

#### 5. **ç”Ÿäº§æ„å»º**

* `mode: production` + `optimization` é…ç½®é¡¹ï¼ˆå‹ç¼©ã€ä»£ç åˆ†å‰²ç­‰ï¼‰
* SourceMap çš„ç±»å‹ä¸ç”Ÿäº§ç¯å¢ƒå»ºè®®é…ç½®ï¼ˆå¦‚ï¼š`cheap-module-source-map`ï¼‰

---

### âš¡ Vite é‡ç‚¹å¤ä¹ æ¨¡å—ï¼ˆé¢è¯•è¶Šæ¥è¶Šå¸¸è§ï¼‰ï¼š

#### 1. **å¼€å‘æ„å»ºæœºåˆ¶**

* å¼€å‘é˜¶æ®µï¼šåŸç”Ÿ ESMï¼Œä½¿ç”¨æµè§ˆå™¨åŠ¨æ€åŠ è½½æ¨¡å—ï¼Œæ— éœ€æ‰“åŒ…
* ç”Ÿäº§é˜¶æ®µï¼šä½¿ç”¨ Rollup æ‰“åŒ…ä¼˜åŒ–ï¼Œé…ç½®é¡¹å…¼å®¹ Rollup æ’ä»¶
* æ”¯æŒ TypeScriptã€Vueã€Reactã€SASS ç­‰è‡ªåŠ¨å¤„ç†

#### 2. **æ ¸å¿ƒåŠŸèƒ½**

* å¿«é€Ÿå¯åŠ¨ï¼ˆä¾èµ–é¢„æ„å»º + åŸç”Ÿæ¨¡å—ï¼‰
* æ’ä»¶ç³»ç»Ÿï¼ˆåŸºäº Rollup + `configureServer` ä¸­é—´ä»¶æœºåˆ¶ï¼‰
* é…ç½®æ–‡ä»¶ vite.config.tsï¼š

  * `plugins` æ’ä»¶æ³¨å†Œ
  * `resolve.alias` é…ç½®
  * `define` å…¨å±€å˜é‡æ³¨å…¥
  * `build.rollupOptions` äº§ç‰©æ§åˆ¶
  * `server.proxy` è·¨åŸŸä»£ç†è®¾ç½®

#### 3. **ä¼˜åŒ–ç›¸å…³**

* `optimizeDeps`ï¼šä¼˜åŒ–ä¾èµ–é¢„æ„å»º
* SSR æ”¯æŒ / PWA æ’ä»¶
* é™æ€èµ„æºå¤„ç†ï¼ˆpublic ç›®å½• vs ç›´æ¥å¯¼å…¥ï¼‰

#### 4. **ä¸ Webpack çš„å¼‚åŒç‚¹ï¼ˆç»“åˆé¡¹ç›®ç»éªŒè¯´æ˜ï¼‰**

* Vite ä¸æ‰“åŒ…ä¾èµ–ï¼Œæ¨¡å—æ˜¯æŒ‰éœ€æ‹‰å–ï¼ˆåªå¤„ç†ä¿®æ”¹æ¨¡å—ï¼‰
* Webpack åœ¨å¼€å‘ç¯å¢ƒæ‰“åŒ…æ…¢ï¼Œä½†ç”Ÿæ€æˆç†Ÿï¼Œå¯æ§æ€§å¼º

---

### ğŸ¯ é¢è¯•å»ºè®®å®æˆ˜é¢˜

å¯ä»¥å‡†å¤‡ä»¥ä¸‹é¢è¯•å›ç­”æˆ–ç¬”è¯•ï¼š

* æ‰‹å†™ç®€æ˜“ç‰ˆ Webpack æ‰“åŒ…æµç¨‹ï¼ˆæˆ– explain æºç æ„å»ºæµç¨‹ï¼‰
* é¡¹ç›®ä¸­ä¼˜åŒ– Webpack æ„å»ºé€Ÿåº¦çš„å®æˆ˜æŠ€å·§
* ç”¨ Vite æ­å»º React/Vue é¡¹ç›®ä¸­å¦‚ä½•å¤„ç†å¤§å‹ç¬¬ä¸‰æ–¹åº“ä¼˜åŒ–
* Webpack å¦‚ä½•å®ç° Tree-shaking å’Œæ‡’åŠ è½½
* Vite æ˜¯å¦‚ä½•åšåˆ°å†·å¯åŠ¨å¿«çš„ï¼Ÿæ˜¯å¦é€‚åˆ SSRï¼Ÿ

---

### ğŸ“˜ æ¨èé¢å¤–ç†è§£ï¼š

* Webpack æ’ä»¶æœºåˆ¶ç”¨çš„æ˜¯ **Tapable**ï¼ˆå‘å¸ƒè®¢é˜…æ¨¡å‹ï¼‰ => å¯ç±»æ¯” Vue ç”Ÿå‘½å‘¨æœŸé’©å­
* Vite å†…éƒ¨ä½¿ç”¨ **esbuild** åšä¾èµ–é¢„æ„å»ºï¼Œè¿œæ¯” Babel å¿«
* äºŒè€…éƒ½å¯ä»¥é€šè¿‡æ’ä»¶è‡ªå®šä¹‰æ„å»ºè¡Œä¸ºï¼ˆä½† Vite æ›´ç°ä»£ï¼‰

---

éœ€è¦æˆ‘æŠŠè¿™ä»½å†…å®¹æ•´ç†æˆ Markdown æ–‡ä»¶æˆ–å¤ä¹ æçº²æ ¼å¼å—ï¼Ÿ



ä»¥ä¸‹æ˜¯é’ˆå¯¹é«˜çº§å‰ç«¯é¢è¯•ä¸­**Webpack / Vite å®æˆ˜é¢˜**æœ€å¸¸è€ƒçš„äº”ä¸ªé—®é¢˜åŠ**æ ‡å‡†ç­”é¢˜å‚è€ƒç­”æ¡ˆ**ï¼Œæ¯é¢˜é™„åŠ ç®€è¦è¯´æ˜ä¸å»¶ä¼¸å»ºè®®ï¼Œæ–¹ä¾¿ä½ é¢è¯•æ—¶çµæ´»å±•å¼€ã€‚

---

## âœ… é¢˜ç›®ä¸€ï¼šè¯·ç®€è¿° Webpack çš„æ„å»ºæµç¨‹ï¼Œå¹¶è¯´æ˜ Loader ä¸ Plugin çš„ä½œç”¨åŒºåˆ«

### ğŸ¯ ç­”é¢˜å‚è€ƒï¼š

Webpack æ„å»ºæµç¨‹ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹ 5 ä¸ªé˜¶æ®µï¼š

1. **åˆå§‹åŒ–**ï¼šè¯»å–é…ç½®ï¼Œæ³¨å†Œæ’ä»¶ï¼ˆé€šè¿‡ Tapableï¼‰ã€‚
2. **æ„å»ºæ¨¡å—ä¾èµ–å›¾**ï¼šä»å…¥å£æ–‡ä»¶é€’å½’è§£æä¾èµ–ï¼Œè°ƒç”¨å¯¹åº” Loader å¤„ç†èµ„æºã€‚
3. **æ¨¡å—è½¬æ¢**ï¼šä½¿ç”¨ Loader å¯¹é JS æ¨¡å—ï¼ˆå¦‚ `.vue`ã€`.scss`ï¼‰è¿›è¡Œè½¬æ¢ä¸º JS æ¨¡å—ã€‚
4. **ç¼–è¯‘ Chunk**ï¼šæŒ‰éœ€åˆå¹¶æ¨¡å—ä¸º Chunkã€‚
5. **è¾“å‡ºèµ„æº**ï¼šè°ƒç”¨ Plugin å¤„ç†èµ„æºï¼ˆå‹ç¼©ã€æ³¨å…¥ HTMLï¼‰ï¼Œæœ€ç»ˆè¾“å‡ºåˆ°æŒ‡å®šè·¯å¾„ã€‚

> **Loader æ˜¯æ¨¡å—è½¬æ¢å™¨**ï¼Œåœ¨æ¨¡å—åŠ è½½æ—¶æŒ‰é¡ºåºå¤„ç†æºæ–‡ä»¶ï¼Œå¦‚ `babel-loader`ã€‚
>
> **Plugin æ˜¯æ‰©å±•å™¨**ï¼Œåœ¨æ„å»ºæµç¨‹çš„å„ä¸ªé˜¶æ®µæ‰§è¡Œé’©å­å‡½æ•°ï¼Œå¦‚ `HtmlWebpackPlugin`ã€`DefinePlugin`ã€‚

### ğŸ’¡ å»¶ä¼¸ï¼š

* Loader æ˜¯å‡½æ•°ï¼Œæœ¬è´¨æ˜¯å¯¹æ¨¡å—æ–‡ä»¶å†…å®¹çš„è½¬æ¢ã€‚
* Plugin æ˜¯ç±»ï¼Œä½¿ç”¨ `apply(compiler)` æ³¨å†Œåˆ° Webpack ç”Ÿå‘½å‘¨æœŸä¸­ã€‚

---

## âœ… é¢˜ç›®äºŒï¼šå¦‚ä½•ç”¨ Webpack å®ç°ä»£ç åˆ†å‰²ï¼ˆCode Splittingï¼‰ï¼Ÿè¯·è¯´æ˜åŸç†ä¸é…ç½®æ–¹å¼

### ğŸ¯ ç­”é¢˜å‚è€ƒï¼š

Webpack æ”¯æŒä¸‰ç§æ–¹å¼å®ç°ä»£ç åˆ†å‰²ï¼š

1. **å…¥å£åˆ†å‰²**ï¼ˆå¤šå…¥å£ï¼‰ï¼š

   ```js
   entry: {
     main: './src/index.js',
     vendor: './src/vendor.js'
   }
   ```

2. **æ‰‹åŠ¨å¼‚æ­¥å¯¼å…¥**ï¼ˆæ¨èï¼‰ï¼š

   ```js
   import('./moduleA').then(...)
   ```

3. **SplitChunksPlugin è‡ªåŠ¨æ‹†åˆ†å…¬å…±æ¨¡å—**ï¼š

   ```js
   optimization: {
     splitChunks: {
       chunks: 'all',
       cacheGroups: {
         vendors: {
           test: /[\\/]node_modules[\\/]/,
           name: 'vendors',
           chunks: 'all',
         }
       }
     }
   }
   ```

> **åŸç†**ï¼šWebpack ä¼šè¯†åˆ«å¼‚æ­¥ä¾èµ–ï¼Œå°†å…¶æ‰“åŒ…æˆç‹¬ç«‹çš„ Chunkï¼ŒæŒ‰éœ€åŠ è½½ï¼Œå‡å°‘é¦–å± JS ä½“ç§¯ã€‚

---

## âœ… é¢˜ç›®ä¸‰ï¼šVite ä¸ºä½•å¯åŠ¨é€Ÿåº¦æ¯” Webpack å¿«ï¼Ÿè¯·è§£é‡Šå…¶åŸç†

### ğŸ¯ ç­”é¢˜å‚è€ƒï¼š

Vite å¯åŠ¨å¿«çš„åŸå› ä¸»è¦æœ‰ä¸¤ç‚¹ï¼š

1. **åŸºäºåŸç”Ÿ ES Module å¼€å‘**ï¼šVite åˆ©ç”¨æµè§ˆå™¨åŸç”Ÿæ”¯æŒçš„ ESMï¼Œåªåœ¨é¦–æ¬¡è¯·æ±‚æ—¶æŒ‰éœ€åŠ è½½æ¨¡å—ï¼Œæ— éœ€æ‰“åŒ…ã€‚
2. **ä¾èµ–é¢„æ„å»º**ï¼šä½¿ç”¨ `esbuild` å¯¹ä¾èµ–è¿›è¡Œä¸€æ¬¡æ€§é¢„æ„å»ºï¼Œé€Ÿåº¦æ¯” Babel å¿« 10-100 å€ã€‚

```js
optimizeDeps: {
  include: ['lodash']
}
```

> Webpack åœ¨å¼€å‘é˜¶æ®µæ‰“åŒ…æ•´ä¸ªä¾èµ–å›¾ï¼Œå¯åŠ¨ç¼“æ…¢ï¼›Vite åˆ©ç”¨åŸç”Ÿæ¨¡å— + esbuildï¼Œä»…é¢„æ„å»ºç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œæå¤§æå‡äº†å¼€å‘ä½“éªŒã€‚

---

## âœ… é¢˜ç›®å››ï¼šè¯·è¯´è¯´ä½ é¡¹ç›®ä¸­ Webpack æ€§èƒ½ä¼˜åŒ–çš„å®æˆ˜ç»éªŒ

### ğŸ¯ ç­”é¢˜å‚è€ƒï¼š

ä»¥ä¸‹æ˜¯æˆ‘å®é™…ä¼˜åŒ–ç»éªŒä¸­å¸¸ç”¨çš„ç­–ç•¥ï¼š

#### æ„å»ºé€Ÿåº¦ä¼˜åŒ–ï¼š

* ä½¿ç”¨ `thread-loader` + `cache-loader` æå‡ Loader æ‰§è¡Œæ•ˆç‡ã€‚
* ç²¾å‡†ä½¿ç”¨ `include` / `exclude` é™åˆ¶ Babel ç¼–è¯‘èŒƒå›´ã€‚
* ä½¿ç”¨ `resolve.alias` åŠ å¿«è·¯å¾„è§£æã€‚

#### æ„å»ºä½“ç§¯ä¼˜åŒ–ï¼š

* å¼€å¯ Tree-shakingï¼ˆä½¿ç”¨ ES Module + `"sideEffects": false`ï¼‰
* ä½¿ç”¨ `MiniCssExtractPlugin` æŠ½ç¦» CSS
* ä½¿ç”¨ `TerserPlugin` å‹ç¼© JS
* æŒ‰éœ€åŠ è½½ï¼ˆä½¿ç”¨ `import()` å¼‚æ­¥åŠ è½½å¤§æ¨¡å—ï¼‰
* ä½¿ç”¨ `webpack-bundle-analyzer` åˆ†æåŒ…ä½“ç§¯

#### ç¤ºä¾‹é…ç½®ï¼š

```js
optimization: {
  minimize: true,
  splitChunks: {
    chunks: 'all',
  },
  runtimeChunk: 'single'
}
```

---

## âœ… é¢˜ç›®äº”ï¼šVite é¡¹ç›®ä¸­å¦‚æœå¼•å…¥å¤§å‹ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ lodashï¼‰ï¼Œå¦‚ä½•è¿›è¡Œä¼˜åŒ–ï¼Ÿ

### ğŸ¯ ç­”é¢˜å‚è€ƒï¼š

Vite ä¸­ä¼˜åŒ–å¤§å‹ä¾èµ–åº“çš„æ–¹æ³•ï¼š

1. **ä¾èµ–é¢„æ„å»ºç¼“å­˜**ï¼š

   ```ts
   optimizeDeps: {
     include: ['lodash']
   }
   ```

   é¿å…å¼€å‘ç¯å¢ƒæ¯æ¬¡éƒ½é‡æ–°è§£æã€‚

2. **æŒ‰éœ€å¼•å…¥**ï¼š
   åˆ©ç”¨ `lodash-es` + Tree-shaking

   ```js
   import debounce from 'lodash-es/debounce'
   ```

3. **ç”Ÿäº§æ‰“åŒ…ä¼˜åŒ–**ï¼ˆRollup é…ç½®ï¼‰ï¼š

   ```ts
   build: {
     rollupOptions: {
       output: {
         manualChunks: {
           lodash: ['lodash-es']
         }
       }
     }
   }
   ```

4. **CDN å¤–é“¾ï¼ˆå¯é€‰ï¼‰**ï¼š
   é…åˆ `vite-plugin-html` ä½¿ç”¨ CDN åŠ é€ŸåŠ è½½ï¼š

   ```js
   define: {
     lodash: 'window._'
   }
   ```

---

### âœ… æ€»ç»“

| è€ƒé¢˜             | æ¶‰åŠæŠ€èƒ½                       | æ¨èæ‹“å±•                           |
| -------------- | -------------------------- | ------------------------------ |
| Webpack æ„å»ºæµç¨‹   | Tapableã€æ¨¡å—ç³»ç»Ÿ               | æ‰‹å†™æ’ä»¶ç»ƒä¹                          |
| Code Splitting | import()ã€SplitChunksPlugin | åŠ¨æ€è·¯ç”±æ‡’åŠ è½½å®è·µ                      |
| Vite å¯åŠ¨åŸç†      | ESM + esbuild              | æ¯”è¾ƒ vite ä¸ Webpack çš„ dev-server |
| æ€§èƒ½ä¼˜åŒ–å®æˆ˜         | Loader ä¼˜åŒ–ã€Plugin è°ƒæ•´        | ä½¿ç”¨ webpack-analyzer            |
| Vite å¤§åŒ…ä¼˜åŒ–      | optimizeDepsã€rollupOptions | åŠ¨æ€å¯¼å…¥ä¸ bundle size å¯¹æ¯”           |

---

éœ€è¦æˆ‘æŠŠè¿™äº›é¢˜ç›® + ç­”æ¡ˆæ•´ç†æˆä¸€ä»½ markdown é¢è¯•æ‰‹å†Œå—ï¼Ÿæˆ–è€…ä½ å¸Œæœ›åŠ ä¸ŠæŸä¸€å—æ‰©å±•é¢˜å‹ï¼Ÿ


ä½ è¿™äº›é—®é¢˜æ¶µç›–äº†é«˜çº§å‰ç«¯é¢è¯•ä¸­éå¸¸å…¸å‹çš„çŸ¥è¯†ç‚¹ï¼Œä¸‹é¢æˆ‘é€ä¸€**ç²¾ç‚¼ã€å‡†ç¡®ã€é«˜æ•ˆ**åœ°ä¸ºä½ è§£ç­”ï¼Œæ–¹ä¾¿ä½ **èƒŒè¯µ+åº”å¯¹é¢è¯•**ã€‚

---

## 1ï¸âƒ£ äº‹ä»¶æ•è·ï¼ˆEvent Capturingï¼‰

### âœ… å®šä¹‰ï¼š

äº‹ä»¶åœ¨ DOM æ ‘ä¸­ä¼ æ’­æ—¶çš„ç¬¬ä¸€é˜¶æ®µï¼Œä» **document â†’ target å…ƒç´ ** çš„è¿‡ç¨‹ï¼Œç§°ä¸º**æ•è·é˜¶æ®µ**ã€‚

### âœ… ä¸‰é˜¶æ®µé¡ºåºï¼š

1. æ•è·é˜¶æ®µï¼ˆcapturing phaseï¼‰
2. ç›®æ ‡é˜¶æ®µï¼ˆtarget phaseï¼‰
3. å†’æ³¡é˜¶æ®µï¼ˆbubbling phaseï¼‰

### âœ… ä¸¾ä¾‹ï¼š

```js
div.addEventListener('click', handler, true); // ç¬¬ä¸‰ä¸ªå‚æ•°ä¸º true è¡¨ç¤ºæ•è·é˜¶æ®µè§¦å‘
```

---

## 2ï¸âƒ£ URL è¯·æ±‚å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿæœ‰ç¼“å­˜æ—¶çš„å“åº”çŠ¶æ€ç ï¼Ÿ304 æ˜¯ä»€ä¹ˆï¼Ÿ

### âœ… è¯·æ±‚å®Œæ•´æµç¨‹ï¼š

1. æµè§ˆå™¨å…ˆæ£€æŸ¥ç¼“å­˜ï¼ˆå¼ºç¼“å­˜ï¼‰
2. å¦‚æœå‘½ä¸­ â†’ è¿”å› 200ï¼ˆfrom disk cache æˆ– memory cacheï¼‰â†’ **ä¸ä¼šå‘è¯·æ±‚**
3. æ²¡å‘½ä¸­å¼ºç¼“å­˜ï¼Œå‘è¯·æ±‚ â†’ æœåŠ¡å™¨æ£€æŸ¥åå•†ç¼“å­˜ï¼ˆIf-Modified-Since / If-None-Matchï¼‰

   * è‹¥èµ„æºæœªä¿®æ”¹ï¼Œè¿”å› **304 Not Modified**
   * å¦åˆ™è¿”å› **200 OK + æ–°èµ„æº**

### âœ… çŠ¶æ€ç å¯¹æ¯”ï¼š

| åœºæ™¯     | çŠ¶æ€ç              | å«ä¹‰         |
| ------ | --------------- | ---------- |
| å‘½ä¸­å¼ºç¼“å­˜  | 200ï¼ˆfrom cacheï¼‰ | ä¸å‘è¯·æ±‚ï¼Œç›´æ¥è¯»ç¼“å­˜ |
| åå•†ç¼“å­˜å‘½ä¸­ | 304             | å‘è¯·æ±‚ï¼Œä½†ä¸è¿”å›èµ„æº |
| æ— ç¼“å­˜    | 200             | è¿”å›å®Œæ•´èµ„æº     |

---

## 3ï¸âƒ£ è·¨é¡µç­¾é€šä¿¡æ€ä¹ˆåšï¼Ÿ

### âœ… ä¸‰ç§ä¸»æµæ–¹å¼ï¼š

#### 1. **BroadcastChannel APIï¼ˆæ¨èï¼‰**

```js
const channel = new BroadcastChannel('my_channel');
channel.postMessage('hello');
channel.onmessage = (e) => console.log(e.data);
```

#### 2. **localStorage + storage äº‹ä»¶ï¼ˆå…¼å®¹æ€§å¥½ï¼‰**

```js
window.addEventListener('storage', (e) => console.log(e));
localStorage.setItem('key', 'value');
```

#### 3. **SharedWorkerï¼ˆå¤æ‚ä½†å¼ºå¤§ï¼‰**

---

## 4ï¸âƒ£ ESModule vs CommonJS åŒºåˆ«

| å¯¹æ¯”é¡¹          | ESModule (ESM)  | CommonJS (CJS)           |
| ------------ | --------------- | ------------------------ |
| å¯¼å…¥å¯¼å‡º         | `import/export` | `require/module.exports` |
| åŠ è½½æ–¹å¼         | é™æ€åˆ†æï¼Œç¼–è¯‘æ—¶åŠ è½½      | è¿è¡Œæ—¶åŠ è½½                    |
| æ˜¯å¦å¼‚æ­¥         | æ”¯æŒå¼‚æ­¥ï¼ˆæµè§ˆå™¨/Nodeï¼‰  | åŒæ­¥                       |
| this æŒ‡å‘      | `undefined`     | æŒ‡å‘ `module.exports`      |
| Tree Shaking | âœ… æ”¯æŒ            | âŒ ä¸æ”¯æŒ                    |

---

## 5ï¸âƒ£ è”é‚¦æ¨¡å—ï¼ˆModule Federationï¼‰æœ‰å•¥ç”¨ï¼Ÿ

### âœ… å®šä¹‰ï¼š

Webpack 5 æå‡ºçš„ **å¾®å‰ç«¯å…±äº«æœºåˆ¶**ï¼Œå…è®¸**å¤šä¸ªé¡¹ç›®é—´å…±äº«æ¨¡å—**ï¼Œå®ç°**è¿œç¨‹åŠ è½½åˆ«äººçš„ä»£ç æ¨¡å—**ã€‚

### âœ… åœºæ™¯ç”¨é€”ï¼š

* å¤šå›¢é˜Ÿå¼€å‘ç‹¬ç«‹é¡¹ç›®æ¨¡å—ï¼ŒåŠ¨æ€åŠ è½½ä½¿ç”¨
* è§£å†³é‡å¤æ‰“åŒ…çš„é—®é¢˜ï¼ˆå…±äº« Reactã€Vueï¼‰
* æ”¯æŒçƒ­æ›´æ–°ã€æŒ‰éœ€åŠ è½½è¿œç¨‹æ¨¡å—

### âœ… ç”¨æ³•å…³é”®é…ç½®ï¼š

```js
new ModuleFederationPlugin({
  name: 'app1',
  remotes: {
    app2: 'app2@http://localhost:8081/remoteEntry.js',
  }
})
```

---

## 6ï¸âƒ£ JSBridge æ˜¯ä»€ä¹ˆï¼Ÿæœ‰å•¥ç”¨ï¼Ÿ

### âœ… å®šä¹‰ï¼š

**JSBridge æ˜¯å‰ç«¯ä¸åŸç”Ÿåº”ç”¨ï¼ˆiOS/Androidï¼‰é€šä¿¡çš„æ¡¥æ¢æœºåˆ¶**ï¼Œç”¨äºåœ¨ WebView ä¸­è°ƒç”¨åŸç”ŸåŠŸèƒ½ï¼ˆå¦‚æ‰«ç ã€æ‹ç…§ï¼‰ã€‚

### âœ… åŸç†ï¼š

* Web ç«¯é€šè¿‡çº¦å®šçš„åè®®è°ƒç”¨ï¼šå¦‚ `window.webkit.messageHandlers.xxx.postMessage()`
* Native æ‹¦æˆªå¹¶è§£æ JS è°ƒç”¨ â†’ æ‰§è¡Œå¯¹åº”åŠŸèƒ½åè¿”å›ç»“æœ â†’ è°ƒç”¨ JS å›è°ƒå‡½æ•°

### âœ… åœºæ™¯ç”¨é€”ï¼š

* å‰ç«¯è°ƒç”¨åŸç”ŸåŠŸèƒ½ï¼ˆæ‰«ç /å®šä½ï¼‰
* åŸç”Ÿæ§åˆ¶ç½‘é¡µè¡Œä¸ºï¼ˆå¯¼èˆª/å›è°ƒï¼‰
* React Native / Hybrid åº”ç”¨é€šä¿¡å…³é”®åŸºç¡€

---

## 7ï¸âƒ£ Fetch æ€ä¹ˆå¤„ç† baseURLï¼Ÿ

### âœ… åŸç”Ÿ Fetch æ²¡æœ‰ `baseURL`ï¼Œä½†ä½ å¯ä»¥å°è£…ï¼š

```js
const baseURL = 'https://api.example.com';
function fetchWithBase(url, options) {
  return fetch(baseURL + url, options);
}
```

### âœ… æ¨èç”¨ axiosï¼š

```js
const axiosInstance = axios.create({ baseURL: 'https://api.example.com' });
axiosInstance.get('/user'); // è‡ªåŠ¨æ‹¼æ¥
```

---

## 8ï¸âƒ£ Webpack / Vite å¸¸è§æ‰‹å†™ç»ƒä¹ é¢˜ï¼ˆé¢è¯•é«˜é¢‘ï¼‰

### âœ… Webpack æ‰‹å†™é¢˜ï¼š

* âœï¸ å®ç°ç®€æ˜“ç‰ˆ `loader`ï¼ˆå¦‚ Markdown è½¬ HTMLï¼‰
* âœï¸ å®ç°ä¸€ä¸ªæ’ä»¶ï¼ˆæ‰“å°æ„å»ºæ—¶é—´ã€èµ„æºå¤§å°ç­‰ï¼‰
* âœï¸ æ¨¡æ‹Ÿ `require()` æ¨¡å—æ”¶é›†æµç¨‹
* âœï¸ Tree-shaking æ‰‹åŠ¨åˆ†æï¼ˆæ ¹æ®å¯¼å‡ºæœªè¢«ä½¿ç”¨ï¼‰

### âœ… Vite æ‰‹å†™é¢˜ï¼š

* âœï¸ ç¼–å†™ä¸€ä¸ªç®€å•æ’ä»¶ï¼ˆæ‹¦æˆªæ–‡ä»¶ã€æ³¨å…¥å˜é‡ï¼‰
* âœï¸ æ‰‹åŠ¨å®ç° `vite.config.ts` ä¸­çš„ aliasã€proxy
* âœï¸ è‡ªå®šä¹‰ dev server ä¸­é—´ä»¶ï¼ˆå¦‚ mock æ¥å£ï¼‰

---

æ˜¯å¦éœ€è¦æˆ‘å°†ä»¥ä¸Šå†…å®¹æ•´ç†æˆä¸€ä»½ Markdown å¤ä¹ æ‰‹å†Œï¼Ÿæˆ–è€…ä½ æƒ³å…ˆå¯¹å…¶ä¸­æŸä¸€å—åŠ æ·±å­¦ä¹ ï¼Ÿ


ä¸‹é¢æ˜¯é’ˆå¯¹ Webpack / Vite çš„å¸¸è§æ‰‹å†™ç»ƒä¹ é¢˜çš„**å®æˆ˜å®ç°ç¤ºä¾‹**ï¼Œé€‚åˆç”¨äº**é¢è¯•è®²è§£ + é¡¹ç›®æ¼”ç¤º + è‡ªæˆ‘ç†è§£åŠ æ·±**ï¼Œå»ºè®®ä½ ç†Ÿç»ƒæŒæ¡å®ç°è¿‡ç¨‹ã€å…³é”® API åŠç­”é¢˜æ€è·¯ã€‚

---

## âœ… 1. å®ç°ç®€æ˜“ Webpack Loaderï¼šMarkdown è½¬ HTML

### ğŸ‘‡ ç¤ºä¾‹ï¼š`markdown-loader.js`

```js
const marked = require('marked');

module.exports = function (source) {
  const html = marked(source);
  return `export default ${JSON.stringify(html)}`;
};
```

### ğŸ“Œ ä½¿ç”¨æ–¹æ³•ï¼ˆwebpack.config.jsï¼‰ï¼š

```js
module.exports = {
  module: {
    rules: [
      {
        test: /\.md$/,
        use: path.resolve(__dirname, './markdown-loader.js'),
      },
    ],
  },
};
```

### ğŸ¯ é¢è¯•è®²è§£è¦ç‚¹ï¼š

* Webpack loader æœ¬è´¨æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¥æ”¶åŸå§‹å†…å®¹ï¼Œè¿”å› JS å­—ç¬¦ä¸²ã€‚
* å¯ç»“åˆ `marked`ã€`gray-matter` å¤„ç† Markdown+Frontmatterã€‚

---

## âœ… 2. å®ç° Webpack æ’ä»¶ï¼šæ‰“å°æ„å»ºæ—¶é—´ + è¾“å‡ºæ–‡ä»¶å¤§å°

### ğŸ‘‡ ç¤ºä¾‹ï¼š`BuildStatsPlugin.js`

```js
class BuildStatsPlugin {
  apply(compiler) {
    compiler.hooks.done.tap('BuildStatsPlugin', (stats) => {
      console.log('\nâœ¨ Build completed at:', new Date().toLocaleTimeString());

      const assets = stats.toJson().assets || [];
      assets.forEach(asset => {
        const sizeKB = (asset.size / 1024).toFixed(2);
        console.log(`ğŸ“¦ ${asset.name} - ${sizeKB} KB`);
      });
    });
  }
}

module.exports = BuildStatsPlugin;
```

### ğŸ“Œ ä½¿ç”¨æ–¹æ³•ï¼ˆwebpack.config.jsï¼‰ï¼š

```js
const BuildStatsPlugin = require('./BuildStatsPlugin');

module.exports = {
  plugins: [
    new BuildStatsPlugin(),
  ],
};
```

### ğŸ¯ é¢è¯•è®²è§£è¦ç‚¹ï¼š

* Webpack æ’ä»¶åŸºäº `Tapable` ç”Ÿå‘½å‘¨æœŸï¼š`compiler.hooks.done.tap(...)`
* å¯ä»¥æ‹¿åˆ° `stats` å¯¹è±¡è¾“å‡ºæ„å»ºç»†èŠ‚ï¼Œåˆ†æåŒ…ä½“ç§¯ç­‰ã€‚

---

## âœ… 3. å®ç° Vite æ’ä»¶ï¼šæ³¨å…¥å…¨å±€å˜é‡

### ğŸ‘‡ ç¤ºä¾‹ï¼š`vite-plugin-inject-global.js`

```js
export default function injectGlobalPlugin() {
  return {
    name: 'vite-plugin-inject-global',
    transformIndexHtml(html) {
      return html.replace(
        '</head>',
        `<script>window.__APP_VERSION__ = "1.0.0"</script></head>`
      );
    },
  };
}
```

### ğŸ“Œ ä½¿ç”¨æ–¹æ³•ï¼ˆvite.config.tsï¼‰ï¼š

```ts
import injectGlobalPlugin from './vite-plugin-inject-global';

export default defineConfig({
  plugins: [injectGlobalPlugin()],
});
```

### ğŸ¯ é¢è¯•è®²è§£è¦ç‚¹ï¼š

* Vite æ’ä»¶éµå¾ª Rollup æ’ä»¶æ ‡å‡†ï¼Œæ”¯æŒæ‰©å±•å¦‚ `transformIndexHtml`ã€‚
* transformIndexHtml æ˜¯ Vite ç‰¹æœ‰é’©å­ï¼Œç”¨äº HTML æ³¨å…¥ã€åŠ¨æ€æ”¹å†™ã€‚

---

## âœ… 4. å®ç° Vite æ’ä»¶ï¼šæ‹¦æˆªç‰¹å®šæ–‡ä»¶ã€æ”¹å†™å†…å®¹

### ğŸ‘‡ ç¤ºä¾‹ï¼šå±è”½ç‰¹å®šæ–‡ä»¶å¯¼å…¥ `.secret.js`

```js
export default function blockSecretPlugin() {
  return {
    name: 'block-secret-plugin',
    load(id) {
      if (id.includes('.secret.js')) {
        return `export default "Access Denied"`; // æ›¿æ¢å†…å®¹
      }
    },
  };
}
```

### ğŸ¯ é¢è¯•è®²è§£è¦ç‚¹ï¼š

* `load(id)` é’©å­å¯ä»¥æ‹¦æˆªå¹¶è¿”å›è‡ªå®šä¹‰å†…å®¹ã€‚
* å¯ç”¨äº mockã€æƒé™æ§åˆ¶ã€è°ƒè¯•æ³¨å…¥ã€‚

---

## ğŸ§  é¢è¯•ç­”é¢˜æ€»ç»“å»ºè®®æ¨¡æ¿ï¼š

> åœ¨æˆ‘å¹³æ—¶åš Webpack/Vite å·¥ç¨‹ä¼˜åŒ–æ—¶ï¼Œæˆ‘å†™è¿‡ä¸€äº› Loader å’Œæ’ä»¶ï¼Œä¾‹å¦‚å®ç°ä¸€ä¸ª Markdown loaderï¼Œå°† `.md` æ–‡ä»¶è½¬ä¸º HTML è¾“å‡ºä¾›ç»„ä»¶ä½¿ç”¨ï¼›ä¹Ÿå†™è¿‡ä¸€ä¸ªæ„å»ºç»Ÿè®¡æ’ä»¶ï¼Œèƒ½åœ¨æ¯æ¬¡æ‰“åŒ…åè¾“å‡ºå„æ–‡ä»¶å¤§å°ä¸æ—¶é—´ï¼Œç”¨äºæŒç»­æ€§èƒ½ç›‘æ§ã€‚åœ¨ Vite ä¸­æˆ‘ç”¨æ’ä»¶æœºåˆ¶åšè¿‡æ³¨å…¥å…¨å±€å˜é‡å’Œ mock æ–‡ä»¶æ‹¦æˆªï¼Œç†Ÿæ‚‰å…¶æ’ä»¶ API å’Œ transformIndexHtmlã€loadã€transform ç­‰ç”Ÿå‘½å‘¨æœŸé’©å­ã€‚

---

å¦‚éœ€æˆ‘æ•´ç†æˆ Markdown æ–‡æ¡£ã€æ·»åŠ æ›´å¤šæ’ä»¶æ¨¡æ¿ï¼ˆæ¯”å¦‚ `vite-plugin-mock` æˆ– `htmlå‹ç¼©æ’ä»¶`ï¼‰ï¼Œå¯ç»§ç»­å‘Šè¯‰æˆ‘ã€‚æ˜¯å¦è¿˜å¸Œæœ›æˆ‘è¡¥å…… loader/plugin çš„åŸç†å›¾è§£æˆ–é¢è¯•æé—®å¥—è·¯ï¼Ÿ



